<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.czhand.zsmq.infra.mapper.EntBaseMapper">
    <resultMap id="BaseResultMap" type="com.czhand.zsmq.domain.EntBase">
        <id column="id" property="id" jdbcType="BIGINT"/>

        <result column="ent_name" property="entName" jdbcType="VARCHAR"/>
        <result column="ent_short_name" property="entShortName" jdbcType="VARCHAR"/>
        <result column="ent_abstract" property="entAbstract" jdbcType="VARCHAR"/>
        <result column="address" property="address" jdbcType="VARCHAR"/>
        <result column="corporation" property="corporation" jdbcType="VARCHAR"/>
        <result column="corporation_tel" property="corporationTel" jdbcType="VARCHAR"/>
        <result column="registered_capital" property="registeredCapital" jdbcType="VARCHAR"/>
        <result column="establish_date" property="establishDate" jdbcType="TIMESTAMP"/>
        <result column="registration_num" property="registrationNum" jdbcType="VARCHAR"/>
        <result column="organizational_code" property="organizationalCode" jdbcType="VARCHAR"/>
        <result column="shareholder" property="shareholder" jdbcType="VARCHAR"/>
        <result column="contacts" property="contacts" jdbcType="VARCHAR"/>
        <result column="contacts_tel" property="contactsTel" jdbcType="VARCHAR"/>
        <result column="site_area" property="siteArea" jdbcType="VARCHAR"/>
        <result column="land_area" property="landArea" jdbcType="VARCHAR"/>
        <result column="property_area" property="propertyArea" jdbcType="VARCHAR"/>

        <result column="is_del" property="isDel" jdbcType="INTEGER"/>
        <result column="version" property="version" jdbcType="BIGINT"/>
        <result column="creation_by" property="creationBy" jdbcType="BIGINT"/>
        <result column="creation_date" property="creationDate" jdbcType="TIMESTAMP"/>
        <result column="update_by" property="updateBy" jdbcType="BIGINT"/>
        <result column="update_date" property="updateDate" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 根据组织机构代码查询该企业是否已存在-->
    <select id="queryExist" parameterType="String" resultType="int">
      select count(organizational_code) as count from ent_base
      where organizational_code=#{organizationalCode}
    </select>

    <!-- 根据组织机构代码查询该企业Id-->
    <select id="queryEntId" parameterType="String" resultType="long">
      select id from ent_base
      where organizational_code=#{organizationalCode}
    </select>

    <!-- 根据组织机构代码查询单个企业-->
    <select id="queryOne" parameterType="String" resultMap="BaseResultMap">
      select * from ent_base where organizational_code=#{organizationalCode}
    </select>

    <!-- 查询所有未删除企业-->
    <select id="queryAll" resultMap="BaseResultMap">
      select * from ent_base where is_del=0
    </select>

    <!-- 查询未删除企业,by模糊匹配企业名称-->
    <select id="queryAllByEntName" parameterType="String" resultMap="BaseResultMap">
        SELECT * from ent_base
        where is_del=0
        <if test="title!=null">
            and ent_name like concat('%',#{entName},'%')
        </if>
    </select>

    <!-- 根据用户ID查询用户所绑定的企业信息-->
    <select id="querryEntBaseByUId" resultMap="BaseResultMap">
      select b.* from user_ent e,ent_base b WHERE e.ent_Id=b.id AND e.user_id=#{userId}
    </select>

</mapper>